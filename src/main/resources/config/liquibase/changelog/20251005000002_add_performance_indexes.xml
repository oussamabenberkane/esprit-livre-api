<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">

    <!--
        Add performance indexes for frequently queried fields.

        Note: Foreign key columns (author_id, user_id, book_id, order_id) already have
        indexes created automatically by PostgreSQL, so they are not duplicated here.
    -->
    <changeSet id="20251005000002-1" author="system">

        <!-- Book table indexes for filtering and search -->
        <createIndex indexName="idx_book_title" tableName="book">
            <column name="title"/>
        </createIndex>

        <createIndex indexName="idx_book_price" tableName="book">
            <column name="price"/>
        </createIndex>

        <createIndex indexName="idx_book_active" tableName="book">
            <column name="active"/>
        </createIndex>

        <!-- Order table indexes for filtering -->
        <createIndex indexName="idx_order_status" tableName="jhi_order">
            <column name="status"/>
        </createIndex>

        <createIndex indexName="idx_order_created_at" tableName="jhi_order">
            <column name="created_at"/>
        </createIndex>

        <!-- Unique index for order tracking by unique ID -->
        <createIndex indexName="idx_order_unique_id" tableName="jhi_order" unique="true">
            <column name="unique_id"/>
        </createIndex>

        <!-- Author table index for search/autocomplete -->
        <createIndex indexName="idx_author_name" tableName="author">
            <column name="name"/>
        </createIndex>

    </changeSet>

</databaseChangeLog>
